{"title":"pycharm中powershell报错无法进入项目conda虚拟环境","uid":"5cda3b996467b8aa197aa1c31ea879ab","slug":"pycharm-powershell-conda-error","date":"2025-07-07T19:46:17.000Z","updated":"2025-07-07T19:55:27.351Z","comments":true,"path":"api/articles/pycharm-powershell-conda-error.json","keywords":null,"cover":null,"content":"<h3 id=\"解决方案\"><a href=\"#解决方案\" class=\"headerlink\" title=\"解决方案\"></a>解决方案</h3><p><font color=\"#dd0000\">在Anaconda3 PowerShell中运行<code>conda init powershell</code></font></p>\n<h3 id=\"问题描述\"><a href=\"#问题描述\" class=\"headerlink\" title=\"问题描述\"></a>问题描述</h3><p>Pycharm Terminal Windows PowerShell启动报错，无法进入项目的conda虚拟环境</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Failed : 无法将“Failed”项识别为 cmdlet、函数、脚本文件或可运行程序的名称。请检查名称的拼写，如果包括路径，请确保路径正确，然后再试一次。</span><br><span class=\"line\">所在位置 行:1 字符: 1</span><br><span class=\"line\">+ Failed to activate conda environment.</span><br><span class=\"line\">+ ~~~~~~</span><br><span class=\"line\">    + CategoryInfo          : ObjectNotFound: (Failed:String) [], CommandNotFoundException</span><br><span class=\"line\">    + FullyQualifiedErrorId : CommandNotFoundException</span><br><span class=\"line\"> </span><br><span class=\"line\">Please : 无法将“Please”项识别为 cmdlet、函数、脚本文件或可运行程序的名称。请检查名称的拼写，如果包括路径，请确保路径正确，然后再试一次。</span><br><span class=\"line\">所在位置 行:2 字符: 2</span><br><span class=\"line\">+  Please open Anaconda prompt, and run `conda init powershell` there.</span><br><span class=\"line\">+  ~~~~~~</span><br><span class=\"line\">    + CategoryInfo          : ObjectNotFound: (Please:String) [], CommandNotFoundException</span><br><span class=\"line\">    + FullyQualifiedErrorId : CommandNotFoundException</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"原因分析\"><a href=\"#原因分析\" class=\"headerlink\" title=\"原因分析\"></a>原因分析</h3><p>查看日志文件：PyCharm -&gt; Help -&gt; Show Log in File Explorer</p>\n<p>idea.log</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">2025-07-08 02:28:19,043 [ 912223]   INFO - #c.j.p.packaging - System conda executable is not found</span><br><span class=\"line\">2025-07-08 02:28:19,044 [ 912224]   WARN - #c.i.p.t.PyVirtualEnvTerminalCustomizer - Can&#x27;t find null, will not activate conda</span><br><span class=\"line\">2025-07-08 02:28:19,088 [ 912268]   INFO - #o.j.p.t.LocalTerminalDirectRunner - Started com.pty4j.windows.conpty.WinConPtyProcess in 11 ms </span><br><span class=\"line\">from [C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe, -NoExit, -ExecutionPolicy, Bypass, -File, </span><br><span class=\"line\">D:\\Program Files\\JetBrains\\PyCharm 2024.1.3\\plugins\\terminal\\shell-integrations\\powershell\\powershell-integration.ps1] </span><br><span class=\"line\">in F:\\work\\PycharmProjects\\FinRobot, [columns=305, rows=19], diff_envs=&#123;FIG_TERM=1, INTELLIJ_TERMINAL_COMMAND_BLOCKS=1, </span><br><span class=\"line\">JEDITERM_SOURCE=Failed to activate conda environment. </span><br><span class=\"line\">Please open Anaconda prompt, and run `conda init powershell` there., </span><br><span class=\"line\">JETBRAINS_INTELLIJ_COMMAND_END_MARKER=, TERMINAL_EMULATOR=JetBrains-JediTerm, TERM_SESSION_ID=&#125;</span><br></pre></td></tr></table></figure>\n\n<p>发现<code>System conda executable is not found</code>，说明找不到conda的可执行文件</p>\n<p>于是查看<code>powershell-integration.ps1</code>文件，发现调用了同目录下的<code>command-block-support.ps1</code></p>\n<p>powershell-integration.ps1</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\">$Hooks = &quot;$PSScriptRoot/command-block-support.ps1&quot;</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n\n<p>command-block-support.ps1</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\">$CondaEnv = if ($Env:CONDA_DEFAULT_ENV -ne $null) &#123; $Env:CONDA_DEFAULT_ENV &#125; else &#123; &quot;&quot; &#125;</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n\n<p>发现加载了系统环境变量<code>CONDA_DEFAULT_ENV</code>，于是查看系统环境变量，发现没有这个变量。</p>\n<p>在环境变量中添加<code>CONDA_DEFAULT_ENV</code>为<code>D:\\Anaconda3</code>（anaconda根目录）后，可以<em><strong>正常进入</strong></em>项目的conda虚拟环境，但是<em><strong>依然报错</strong></em>。</p>\n<p>于是在PATH环境变量中添加condabin的路径：<code>D:\\Anaconda3\\condabin</code>，<strong>恢复正常</strong>。</p>\n<h3 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h3><ol>\n<li>在环境变量中添加默认conda环境，<code>CONDA_DEFAULT_ENV=[Anaconda根目录]</code></li>\n<li>在PAHT中添加conda的bin目录，<code>[Anaconda根目录]\\condabin</code></li>\n</ol>\n<h3 id=\"其他分析\"><a href=\"#其他分析\" class=\"headerlink\" title=\"其他分析\"></a>其他分析</h3><p>在<code>文档\\WindowsPowerShell</code>目录下，有PowerShell脚本<code>profile.ps1</code>，应该是之前安装Miniconda时运行<code>conda init powershell</code>生成的，尝试修改这个文件中的conda目录无效。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#region conda initialize</span><br><span class=\"line\"># !! Contents within this block are managed by &#x27;conda init&#x27; !!</span><br><span class=\"line\">If (Test-Path &quot;D:\\Anaconda3\\Scripts、conda.exe&quot;) &#123;</span><br><span class=\"line\">    (&amp; &quot;D:\\Anaconda3\\Scripts\\conda.exe&quot; &quot;shell.powershell&quot; &quot;hook&quot;) | Out-String | ?&#123;$_&#125; | Invoke-Expression</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">#endregion</span><br></pre></td></tr></table></figure>\n\n<p>查看<a href=\"https://github.com/conda/conda/blob/main/conda/core/initialize.py\">anaconda源码</a>的<code>initialize.py</code>,<br>发现<code>conda init powershell</code>会生成<code>profile.ps1</code>文件，并且添加condabin环境变量。</p>\n","feature":true,"text":"解决方案在Anaconda3 PowerShell中运行conda init powershell 问题描述Pycharm Terminal Windows P...","permalink":"/post/pycharm-powershell-conda-error","photos":[],"count_time":{"symbolsCount":"3k","symbolsTime":"3 mins."},"categories":[{"name":"Bug","slug":"Bug","count":1,"path":"api/categories/Bug.json"}],"tags":[{"name":"Pycharm","slug":"Pycharm","count":1,"path":"api/tags/Pycharm.json"},{"name":"Conda","slug":"Conda","count":1,"path":"api/tags/Conda.json"},{"name":"PowerShell","slug":"PowerShell","count":1,"path":"api/tags/PowerShell.json"},{"name":"Windows","slug":"Windows","count":2,"path":"api/tags/Windows.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88\"><span class=\"toc-text\">解决方案</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0\"><span class=\"toc-text\">问题描述</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%8E%9F%E5%9B%A0%E5%88%86%E6%9E%90\"><span class=\"toc-text\">原因分析</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%80%BB%E7%BB%93\"><span class=\"toc-text\">总结</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%85%B6%E4%BB%96%E5%88%86%E6%9E%90\"><span class=\"toc-text\">其他分析</span></a></li></ol>","author":{"name":"Kevin","slug":"blog-author","avatar":"/static/kevin_logo_x_s1.png","link":"/","description":"AI/FS/BD/WEB/New Media","socials":{"github":"https://github.com/SuiKevin","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{},"next_post":{"title":"windows系统刻录光盘教程_刻录系统光盘教程-CSDN博客【转载】","uid":"b99718bea3cc16756aa515dc86531783","slug":"windows-disc-burning","date":"2025-03-22T06:49:32.000Z","updated":"2025-03-22T10:49:14.041Z","comments":true,"path":"api/articles/windows-disc-burning.json","keywords":null,"cover":[],"text":"windows系统刻录光盘教程_刻录系统光盘教程-CSDN博客 Excerpt文章浏览阅读1.2k次，点赞9次，收藏7次。工作中如果有重要资料需要刻录成光盘该如...","permalink":"/post/windows-disc-burning","photos":[],"count_time":{"symbolsCount":989,"symbolsTime":"1 mins."},"categories":[{"name":"Tools","slug":"Tools","count":1,"path":"api/categories/Tools.json"}],"tags":[{"name":"Windows","slug":"Windows","count":2,"path":"api/tags/Windows.json"},{"name":"Disc Burning","slug":"Disc-Burning","count":1,"path":"api/tags/Disc-Burning.json"}],"author":{"name":"Kevin","slug":"blog-author","avatar":"/static/kevin_logo_x_s1.png","link":"/","description":"AI/FS/BD/WEB/New Media","socials":{"github":"https://github.com/SuiKevin","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true}}